# history-filter-select
#
# select history using filter-select
#
# usage:
#   put this file and filter-select under $fpath,
#   add these lines to your .zshrc:
#
#       autoload -U history-filter-select
#       zle -N history-filter-select
#       bindkey '^s' history-filter-select
autoload -U filter-select
zmodload zsh/parameter

function history-filter-select() {
    local reply=''
    filter-select -A history -r
    if [[ $? == 0 ]]; then
        BUFFER="${reply}"
        zle accept-line
    elif [[ -n "${reply}" ]]; then
        # meta + enter pressed
        # only update BUFFER, not execute
        LBUFFER="${reply}"
        RBUFFER=""
    fi
}

history-filter-select "$@"
